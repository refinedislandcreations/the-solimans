{%- assign c = page.contact -%}
<section class="max-w-6xl mx-auto px-6 md:px-10 py-16" id="contact">
  <h2 class="font-display text-4xl md:text-5xl">
    {{ c.title | default: 'CONTACT US' }}
  </h2>

  <form id="contact-form"
        action="{{ c.action | default: 'https://formsubmit.co/' | append: (c.to_email | default: 'garyhtg26@gmail.com') }}"
        method="POST"
        class="mt-8 grid gap-6">

    <!-- FormSubmit controls -->
    <input type="hidden" name="_subject"  value="{{ c.subject  | default: 'New website inquiry - The Solimans' }}">
    <input type="hidden" name="_template" value="table">
    <input type="hidden" name="_captcha"  value="{{ c.captcha | default: 'false' }}">
    {%- if c.next -%}<input type="hidden" name="_next" value="{{ c.next }}">{%- endif -%}
    <input type="text" name="_honey" style="display:none" tabindex="-1" autocomplete="off">

    <!-- 2-column layout: left fields, right message -->
    <div class="grid md:grid-cols-2 gap-6">
      <!-- LEFT -->
      <div class="space-y-4">
        <input name="name" required autocomplete="name"
               class="w-full rounded-xl border border-slate-300/60 bg-white/80 dark:bg-white/5 dark:border-white/10 px-4 py-3"
               placeholder="{{ c.fields.name | default: 'Name' }}">

        <input type="email" name="email" required autocomplete="email"
               class="w-full rounded-xl border border-slate-300/60 bg-white/80 dark:bg-white/5 dark:border-white/10 px-4 py-3"
               placeholder="{{ c.fields.email | default: 'Email' }}">

        <!-- Phone with intl-tel-input -->
        <input id="phone" type="tel" inputmode="tel" autocomplete="tel"
               class="w-full rounded-xl border border-slate-300/60 bg-white/80 dark:bg-white/5 dark:border-white/10 px-4 py-3"
               placeholder="{{ c.fields.whatsapp | default: 'WhatsApp number' }}">
        <input type="hidden" name="whatsapp" id="whatsappFull">
      </div>

      <!-- RIGHT (message) -->
      <div>
        <textarea name="message" required
          class="w-full h-[190px] resize-none rounded-xl border border-slate-300/60 bg-white/80 dark:bg-white/5 dark:border-white/10 px-4 py-3 leading-normal"
          rows="1"
          placeholder="{{ c.fields.message | default: 'Message' }}"></textarea>
      </div>
    </div>

    <div>
      <button type="submit"
        class="inline-flex items-center gap-2 px-6 py-3
               bg-[#a4b35a] font-semibold shadow-md
               hover:bg-[#bccb6a] hover:shadow-lg
               focus:outline-none focus:ring-4 focus:ring-[#a4b35a]/40
               transition w-auto">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"></path>
        </svg>
        {{ c.submit_text | default: 'SUBMIT' }}
      </button>
    </div>
  </form>

  {% if c.map_src %}
  <div class="mt-6 rounded-md overflow-hidden border border-slate-200/50 dark:border-white/10">
    <iframe
      src="{{ c.map_src }}"
      width="100%"
      height="{{ c.map_height | default: 400 }}"
      style="border:0;"
      allowfullscreen=""
      loading="lazy"
      referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>
  {% endif %}

  <!-- intl-tel-input assets -->
  <link data-iti rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css">
  <script data-iti src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
  <script data-iti src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js"></script>

  <style>
    /* dark dropdown visibility */
    .dark .iti__country-list { background-color:#0b0b0b; color:#e5e7eb; }
    .dark .iti__country-list .iti__country-name,
    .dark .iti__country-list .iti__dial-code { color:#e5e7eb; }
    .dark .iti__country.iti__highlight, .dark .iti__country:hover { background:#1f2937; }
    .dark .iti__search-input { background:#111827; color:#e5e7eb; border-color:#374151; }
    .iti__country-list { background:#fff; color:#111827; }
    .iti__country.iti__highlight, .iti__country:hover { background:#f3f4f6; }
    .iti__search-input { background:#fff; color:#111827; border-color:#e5e7eb; }
    .iti__flag { transform: scale(0.9); transform-origin: left center; }
    .iti { display:block; width:100%; }
    .iti input { width:100%; } /* jaga-jaga di beberapa browser */
  </style>

  <script>
  (function(){
    const form = document.getElementById('contact-form');
    const input = document.getElementById('phone');
    const out   = document.getElementById('whatsappFull');
    if (!form || !input || !out) return;

    const initial = "{{ c.initial_country | default: 'id' | downcase }}";
    const iti = window.intlTelInput(input, {
      initialCountry: initial,
      nationalMode: false,
      separateDialCode: true,
      utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js"
    });

    form.addEventListener('submit', function(){
      out.value = iti.getNumber(); // +628...
    });
  })();
  </script>
</section>
